<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <!-- iOSアプリ化のためのビューポート設定（ズーム禁止、セーフエリア対応） -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>メールテンプレート管理アプリ</title>
  
  <!-- iPhoneホーム画面に追加した際のアプリアイコン・フルスクリーン設定 -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="メール管理">
  <!-- 仮のアプリアイコン（お好きな画像に変更できます） -->
  <link rel="apple-touch-icon" href="https://via.placeholder.com/180/0f172a/ffffff?text=Mail">

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    /* iOSでの操作感をアプリに近づけるスタイル */
    body {
      -webkit-tap-highlight-color: transparent; /* タップ時のグレーの背景を消す */
    }
    .custom-scrollbar::-webkit-scrollbar { width: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #64748b; }
    .animate-fade-in-up { animation: fadeInUp 0.3s ease-out; }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translate(-50%, 10px); }
      to { opacity: 1; transform: translate(-50%, 0); }
    }
    
    /* iPhoneのノッチ（画面の切り欠き）や下部バーを避けるための設定 */
    .pt-safe { padding-top: env(safe-area-inset-top); }
    .mt-safe { margin-top: env(safe-area-inset-top); }
    .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    // 軽量化のため、使用するアイコンをSVGとして直接定義しています
    const Icon = ({ path, size = 24, className = "" }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        {path}
      </svg>
    );
    const Search = (p) => <Icon {...p} path={<g><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></g>} />;
    const Copy = (p) => <Icon {...p} path={<g><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></g>} />;
    const Plus = (p) => <Icon {...p} path={<g><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></g>} />;
    const Edit2 = (p) => <Icon {...p} path={<g><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></g>} />;
    const Trash2 = (p) => <Icon {...p} path={<g><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2-2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></g>} />;
    const Check = (p) => <Icon {...p} path={<polyline points="20 6 9 17 4 12"/>} />;
    const Send = (p) => <Icon {...p} path={<g><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></g>} />;
    const Folder = (p) => <Icon {...p} path={<g><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></g>} />;
    const MessageSquare = (p) => <Icon {...p} path={<g><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></g>} />;
    const Clock = (p) => <Icon {...p} path={<g><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></g>} />;
    const RotateCcw = (p) => <Icon {...p} path={<g><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></g>} />;
    const Save = (p) => <Icon {...p} path={<g><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></g>} />;
    const X = (p) => <Icon {...p} path={<g><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></g>} />;
    const Menu = (p) => <Icon {...p} path={<g><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></g>} />;

    // --- 初期データ定義 ---
    const CATEGORY_GROUPS = [
      {
        id: 'general',
        label: '',
        items: [
          { id: 'all', name: 'すべて', icon: <Folder size={18} /> },
        ]
      },
      {
        id: 'standard',
        label: '通常対応',
        items: [
          { id: 'initial', name: '初期対応', icon: <MessageSquare size={18} /> },
          { id: 'followup', name: '追撃・検討伺い', icon: <Clock size={18} /> },
          { id: 'reengage', name: '長期・掘り起こし', icon: <RotateCcw size={18} /> },
        ]
      },
      {
        id: 'satei',
        label: '一括査定対応用',
        items: [
          { id: 'satei_initial', name: '初期対応（一括査定）', icon: <MessageSquare size={18} /> },
          { id: 'satei_followup', name: '追客・追撃（一括査定）', icon: <Clock size={18} /> },
          { id: 'satei_reengage', name: '長期・掘り起こし（一括査定）', icon: <RotateCcw size={18} /> },
        ]
      }
    ];

    const ALL_CATEGORIES = CATEGORY_GROUPS.flatMap(group => group.items);

    const INITIAL_TEMPLATES = [
      {
        id: 1,
        title: '資料請求へのお礼（即レス用）',
        category: 'initial',
        subject: '【資料送付のご案内】株式会社リード・リアルエステート札幌支店 担当の三宮（さんのみや）です',
        body: `〇〇株式会社
〇〇様

お世話になっております。
株式会社リード・リアルエステート札幌支店の三宮（さんのみや）でございます。

この度は、弊社サービスの資料をご請求いただき、
誠にありがとうございます。

早速ではございますが、資料（PDF）をお送りいたします。
添付ファイルをご確認いただけますでしょうか。

＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
■添付資料
・会社概要.pdf
・サービス紹介資料.pdf
・導入事例集.pdf
＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝

貴社の課題解決の一助となれば幸いです。

ご不明点や、「まずは話を聞いてみたい」というご要望がございましたら、
本メールへの返信、または下記電話番号までお気軽にご連絡ください。

引き続き何卒よろしくお願い申し上げます。`
      },
      {
        id: 2,
        title: '日程調整の打診（初回）',
        category: 'initial',
        subject: '【お打ち合わせのご相談】株式会社リード・リアルエステート札幌支店',
        body: `〇〇株式会社
〇〇様

お世話になっております。
株式会社リード・リアルエステート札幌支店の三宮（さんのみや）でございます。

先ほどは資料をご覧いただきありがとうございました。
もしよろしければ、貴社の現状や課題感に合わせて
より具体的な事例やデモンストレーションをご紹介できればと考えております。

つきましては、20分～30分ほどオンラインにて
情報交換のお時間をいただけないでしょうか。

以下の日程でご都合はいかがでしょうか。

■候補日時
・〇月〇日（曜） 10:00～18:00
・〇月〇日（曜） 13:00～16:00
・〇月〇日（曜） 10:00～12:00

上記以外をご希望の場合は、〇〇様のご都合の良い日時を
いくつかいただけますと幸いです。

ご検討のほど、よろしくお願い申し上げます。`
      },
      {
        id: 3,
        title: '検討状況の確認（1週間後）',
        category: 'followup',
        subject: '先日お送りした資料につきまして【株式会社リード・リアルエステート札幌支店】',
        body: `〇〇株式会社
〇〇様

お世話になっております。
株式会社リード・リアルエステート札幌支店の三宮です。

先日お送りいたしました資料はご覧いただけましたでしょうか。

もしご不明な点や、
「もっとここを詳しく知りたい」といった箇所がございましたら、
担当の私までお気軽にお申し付けください。

また、同業他社様での導入事例などをまとめた
追加資料もご用意が可能でございます。

ご興味がございましたら、ぜひ一度情報提供の機会をいただけますと幸いです。

お手すきの際にご返信いただけますと幸いです。
よろしくお願いいたします。`
      },
      {
        id: 4,
        title: '音信不通時の再連絡（クッション）',
        category: 'followup',
        subject: '【再送】ご検討状況はいかがでしょうか',
        body: `〇〇株式会社
〇〇様

いつも大変お世話になっております。
株式会社リード・リアルエステート札幌支店の三宮です。

度々のご連絡となり大変恐縮でございます。

以前ご提案させていただきました件につきまして、
その後、社内でのご検討状況はいかがでしょうか。

ご多忙中とは存じますが、
現状について一言だけでもご教示いただけますと幸いです。
（「時期尚早」「他社に決定」等でも構いません）

何卒よろしくお願い申し上げます。`
      },
      {
        id: 5,
        title: '半年後の掘り起こし（新機能・事例）',
        category: 'reengage',
        subject: '【新機能のご案内】貴社の課題解決に役立つ機能が追加されました',
        body: `〇〇株式会社
〇〇様

大変ご無沙汰しております。
株式会社リード・リアルエステート札幌支店の三宮でございます。

以前は弊社サービスをご検討いただき、誠にありがとうございました。

この度、以前〇〇様が懸念されていた点を解消できる
「新機能」がリリースされましたので、
改めてご案内させていただきたくご連絡いたしました。

▼新機能のお知らせ
（URLや詳細を記載）

現在の貴社の状況に合わせて、
改めてお役に立てるご提案ができるかと存じます。

もしよろしければ、最新の資料をお送りするか、
一度近況をお伺いできればと考えております。

ご興味をお持ちいただけましたら、
本メールへご返信いただけますと幸いです。

季節の変わり目ですので、ご自愛くださいませ。`
      },
      {
        id: 6,
        title: '【SMS用】所在地不明・電話不通時',
        category: 'satei_initial',
        subject: '（SMS用のため件名不要）',
        body: `【［媒体名］不動産査定の件】
［お客様名］様

株式会社リード・リアルエステート札幌支店の三宮平（さんのみや）です。

先ほど、携帯番号［070-4485-9305］よりお電話差し上げました。
お仕事中でしたでしょうか、失礼いたしました。

［物件のエリア・種別］に関しまして、正確な所在地などの査定に必要なご情報が不足しておりましたので、ご確認させていただきたく存じます。

お手すきの際に、こちらの携帯（またはSMS）へ折り返しいただけますと幸いです。

お電話でのご対応が難しい場合は、その旨をご返信くださいませ。

担当:三宮(070-4485-9305)`
      },
      {
        id: 8,
        title: '机上査定報告書の送付（Eメール）',
        category: 'satei_initial',
        subject: '【机上査定報告書のご送付】株式会社リード・リアルエステート札幌支店 担当：三宮',
        body: `〇〇 様

突然のご連絡にて失礼いたします。
株式会社リード・リアルエステート 札幌支店の三宮（さんのみや）と申します。

この度は、不動産一括査定サイト「［媒体名］」を通じて、 
ご所有不動産の査定をご依頼いただき、誠にありがとうございます。

【査定物件】 ［査定物件の住所］

［媒体名］運営のオペレーター様を通じて、 
「［お客様のご事情1］」
「［お客様のご事情2］」 
というご事情を承りました。

机上査定にはなりますが、下記3点の資料データを添付いたしますので、
ご査収いただきますようお願いいたします。

〇査定報告書
〇調査レポートおよび調査資料
〇成約事例／近隣販売在庫

お手数をおかけいたしますが、メールをご確認できた場合、
その旨のご返信をいただきたく存じます。
データ添付ですと、迷惑メールに入ってしまっている場合があります。

何卒、よろしくお願いいたします。`
      }
    ];

    function EmailTemplateApp() {
      const [activeCategory, setActiveCategory] = useState('satei_initial');
      const [searchQuery, setSearchQuery] = useState('');
      const [templates, setTemplates] = useState(INITIAL_TEMPLATES);
      const [editingTemplate, setEditingTemplate] = useState(null);
      const [notification, setNotification] = useState(null);
      const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);

      const showNotification = (message) => {
        setNotification(message);
        setTimeout(() => setNotification(null), 3000);
      };

      const copyToClipboard = (text, label) => {
        const textArea = document.createElement("textarea");
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        try {
          document.execCommand('copy');
          showNotification(`${label}をコピーしました`);
        } catch (err) {
          console.error('Copy failed', err);
          showNotification('コピーに失敗しました');
        }
        document.body.removeChild(textArea);
      };

      const filteredTemplates = templates.filter(t => {
        const matchesCategory = activeCategory === 'all' || t.category === activeCategory;
        const matchesSearch = 
          t.title.includes(searchQuery) || 
          t.subject.includes(searchQuery) || 
          t.body.includes(searchQuery);
        return matchesCategory && matchesSearch;
      });

      const handleDelete = (id) => {
        if (window.confirm('このテンプレートを削除してもよろしいですか？')) {
          setTemplates(templates.filter(t => t.id !== id));
          showNotification('テンプレートを削除しました');
        }
      };

      const handleSave = (template) => {
        if (template.id) {
          setTemplates(templates.map(t => t.id === template.id ? template : t));
          showNotification('テンプレートを更新しました');
        } else {
          const newId = Math.max(...templates.map(t => t.id), 0) + 1;
          setTemplates([...templates, { ...template, id: newId }]);
          showNotification('新しいテンプレートを作成しました');
        }
        setEditingTemplate(null);
      };

      return (
        // iOS Safariのバーを考慮し min-h-[100dvh] を使用
        <div className="min-h-[100dvh] bg-gray-50 text-gray-800 font-sans flex flex-col md:flex-row relative">
          
          {isMobileMenuOpen && (
            <div 
              className="fixed inset-0 bg-slate-900/50 z-40 md:hidden backdrop-blur-sm transition-opacity"
              onClick={() => setIsMobileMenuOpen(false)}
            />
          )}

          <aside className={`fixed pt-safe inset-y-0 left-0 z-50 w-72 bg-slate-800 text-white flex flex-col transform transition-transform duration-300 ease-in-out md:relative md:translate-x-0 md:w-64 ${isMobileMenuOpen ? 'translate-x-0' : '-translate-x-full'}`}>
            <div className="p-6 flex justify-between items-center mt-safe">
              <div>
                <h1 className="text-xl font-bold flex items-center gap-2">
                  <Send size={24} className="text-blue-400" />
                  Mail Templates
                </h1>
                <p className="text-xs text-slate-400 mt-1">営業・CSメール効率化ツール</p>
              </div>
              <button 
                className="md:hidden text-gray-400 hover:text-white p-1"
                onClick={() => setIsMobileMenuOpen(false)}
              >
                <X size={24} />
              </button>
            </div>
            
            <nav className="px-2 pb-4 overflow-y-auto max-h-[calc(100vh-160px)] custom-scrollbar">
              {CATEGORY_GROUPS.map(group => (
                <div key={group.id} className="mb-6">
                  {group.label && (
                    <h3 className="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 px-4">
                      {group.label}
                    </h3>
                  )}
                  <div className="space-y-1">
                    {group.items.map(cat => (
                      <button
                        key={cat.id}
                        onClick={() => {
                          setActiveCategory(cat.id);
                          setEditingTemplate(null);
                          setIsMobileMenuOpen(false);
                        }}
                        className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm transition-colors ${
                          activeCategory === cat.id 
                            ? 'bg-blue-600 text-white shadow-md' 
                            : 'text-slate-300 hover:bg-slate-700'
                        }`}
                      >
                        {cat.icon}
                        {cat.name}
                      </button>
                    ))}
                  </div>
                </div>
              ))}
            </nav>

            <div className="p-4 border-t border-slate-700 mt-auto pb-safe">
               <button 
                 onClick={() => {
                   setEditingTemplate({ title: '', category: activeCategory === 'all' ? 'satei_initial' : activeCategory, subject: '', body: '' });
                   setIsMobileMenuOpen(false);
                 }}
                 className="w-full bg-emerald-600 hover:bg-emerald-500 text-white py-3 px-4 rounded-lg flex items-center justify-center gap-2 transition-colors shadow-sm font-medium"
               >
                 <Plus size={18} />
                 新規テンプレート
               </button>
            </div>
          </aside>

          {/* iOS Safariのバーを考慮し h-[100dvh] を使用 */}
          <main className="flex-1 h-[100dvh] overflow-hidden flex flex-col relative w-full pt-safe">
            
            <header className="bg-white border-b border-gray-200 p-4 shadow-sm z-10 sticky top-0">
              <div className="max-w-5xl mx-auto flex flex-col sm:flex-row justify-between sm:items-center gap-4">
                <div className="flex items-center gap-3">
                  <button 
                    className="md:hidden p-2 -ml-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"
                    onClick={() => setIsMobileMenuOpen(true)}
                  >
                    <Menu size={24} />
                  </button>
                  <h2 className="text-lg font-semibold text-gray-700 flex items-center gap-2">
                    {ALL_CATEGORIES.find(c => c.id === activeCategory)?.name || 'すべて'}
                    <span className="text-sm font-normal text-gray-500 ml-1">
                      ({filteredTemplates.length}件)
                    </span>
                  </h2>
                </div>
                <div className="relative w-full sm:w-80">
                  <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" size={18} />
                  <input 
                    type="text" 
                    placeholder="キーワードで検索..." 
                    className="w-full pl-10 pr-4 py-3 sm:py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-base sm:text-sm"
                    value={searchQuery}
                    onChange={(e) => setSearchQuery(e.target.value)}
                  />
                </div>
              </div>
            </header>

            <div className="flex-1 overflow-y-auto p-4 md:p-6 bg-gray-50 pb-safe">
              <div className="max-w-5xl mx-auto">
                
                {editingTemplate ? (
                  <Editor 
                    template={editingTemplate} 
                    onSave={handleSave} 
                    onCancel={() => setEditingTemplate(null)} 
                    categories={CATEGORY_GROUPS}
                    showNotification={showNotification}
                  />
                ) : (
                  <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    {filteredTemplates.length > 0 ? (
                      filteredTemplates.map(template => (
                        <TemplateCard 
                          key={template.id} 
                          template={template} 
                          onCopy={copyToClipboard}
                          onEdit={setEditingTemplate}
                          onDelete={handleDelete}
                          getCategoryName={(id) => ALL_CATEGORIES.find(c => c.id === id)?.name}
                        />
                      ))
                    ) : (
                      <div className="col-span-full text-center py-20 text-gray-400">
                        <p>該当するテンプレートが見つかりません。</p>
                      </div>
                    )}
                  </div>
                )}
              </div>
            </div>

            {notification && (
              <div className="absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-full shadow-lg flex items-center gap-2 animate-fade-in-up z-50">
                <Check size={16} className="text-green-400" />
                <span className="text-sm font-medium">{notification}</span>
              </div>
            )}
          </main>
        </div>
      );
    }

    function TemplateCard({ template, onCopy, onEdit, onDelete, getCategoryName }) {
      return (
        <div className="bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-200 flex flex-col h-full">
          <div className="p-4 border-b border-gray-100 bg-gray-50/50 rounded-t-xl flex justify-between items-start">
            <div>
              <span className="inline-block px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-700 mb-2">
                {getCategoryName(template.category)}
              </span>
              <h3 className="font-bold text-gray-800 text-lg leading-tight">{template.title}</h3>
            </div>
            <div className="flex gap-1 ml-2">
              <button onClick={() => onEdit(template)} className="p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors" title="編集">
                <Edit2 size={20} />
              </button>
              <button onClick={() => onDelete(template.id)} className="p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors" title="削除">
                <Trash2 size={20} />
              </button>
            </div>
          </div>
          
          <div className="p-4 flex-1">
            <div className="mb-4">
              <div className="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1 flex justify-between items-center">
                件名
                <button 
                  onClick={() => onCopy(template.subject, '件名')}
                  className="text-blue-600 hover:text-blue-800 text-xs flex items-center gap-1 bg-blue-50 px-2 py-1 rounded hover:bg-blue-100 transition-colors"
                >
                  <Copy size={12} /> コピー
                </button>
              </div>
              <div className="bg-gray-50 p-2 rounded border border-gray-200 text-sm text-gray-800 break-words font-medium">
                {template.subject}
              </div>
            </div>
            
            <div>
              <div className="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-1 flex justify-between items-center">
                本文
                <button 
                  onClick={() => onCopy(template.body, '本文')}
                  className="text-blue-600 hover:text-blue-800 text-xs flex items-center gap-1 bg-blue-50 px-2 py-1 rounded hover:bg-blue-100 transition-colors"
                >
                  <Copy size={12} /> コピー
                </button>
              </div>
              <div className="relative group">
                <div className="bg-gray-50 p-3 rounded border border-gray-200 text-sm md:text-sm text-gray-600 font-mono whitespace-pre-wrap h-48 md:h-40 overflow-y-auto group-hover:border-blue-300 transition-colors">
                  {template.body}
                </div>
                <div className="absolute bottom-3 right-3 opacity-90 md:opacity-0 md:group-hover:opacity-100 transition-opacity">
                  <button 
                    onClick={() => onCopy(template.body, '本文')}
                    className="bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition-colors flex items-center justify-center"
                    title="本文をコピー"
                  >
                    <Copy size={18} />
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    }

    function Editor({ template, onSave, onCancel, categories, showNotification }) {
      const [formData, setFormData] = useState({ ...template });

      const handleChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({ ...prev, [name]: value }));
      };

      const handleSubmit = (e) => {
        e.preventDefault();
        if (!formData.title || !formData.subject || !formData.body) {
          showNotification('すべての項目を入力してください');
          return;
        }
        onSave(formData);
      };

      return (
        <div className="bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden">
          <div className="bg-gray-800 text-white px-6 py-4 flex justify-between items-center">
            <h3 className="text-lg font-bold flex items-center gap-2">
              {template.id ? <Edit2 size={20} /> : <Plus size={20} />}
              {template.id ? 'テンプレートを編集' : '新規テンプレート作成'}
            </h3>
            <button onClick={onCancel} className="text-gray-400 hover:text-white transition-colors">
              <X size={24} />
            </button>
          </div>
          
          <form onSubmit={handleSubmit} className="p-6">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">管理タイトル</label>
                <input
                  type="text"
                  name="title"
                  value={formData.title}
                  onChange={handleChange}
                  placeholder="例：資料請求お礼メール"
                  className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none text-base sm:text-sm"
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">カテゴリー</label>
                <select
                  name="category"
                  value={formData.category}
                  onChange={handleChange}
                  className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none text-base sm:text-sm bg-white"
                >
                  {categories.map(group => (
                    group.id !== 'general' && (
                      <optgroup key={group.id} label={group.label}>
                        {group.items.map(c => (
                          <option key={c.id} value={c.id}>{c.name}</option>
                        ))}
                      </optgroup>
                    )
                  ))}
                </select>
              </div>
            </div>

            <div className="mb-6">
              <label className="block text-sm font-medium text-gray-700 mb-1">件名</label>
              <input
                type="text"
                name="subject"
                value={formData.subject}
                onChange={handleChange}
                placeholder="メールの件名を入力"
                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none text-base sm:text-sm"
              />
            </div>

            <div className="mb-6">
              <label className="block text-sm font-medium text-gray-700 mb-1">本文</label>
              <textarea
                name="body"
                value={formData.body}
                onChange={handleChange}
                placeholder="メールの本文を入力"
                className="w-full p-3 border border-gray-300 rounded-lg h-64 font-mono text-base sm:text-sm focus:ring-2 focus:ring-blue-500 focus:outline-none resize-y"
              />
              <p className="text-xs text-gray-500 mt-2">※ 〇〇や△△などのプレースホルダーを使って汎用的に作成することをお勧めします。</p>
            </div>

            <div className="flex justify-end gap-3 pt-4 border-t border-gray-100">
              <button
                type="button"
                onClick={onCancel}
                className="px-5 py-2 text-gray-600 hover:bg-gray-100 rounded transition-colors"
              >
                キャンセル
              </button>
              <button
                type="submit"
                className="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded shadow transition-colors flex items-center gap-2"
              >
                <Save size={18} />
                保存する
              </button>
            </div>
          </form>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<EmailTemplateApp />);
  </script>
</body>
</html>